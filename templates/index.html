<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Projeto APC - Animais em Extinção</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <h1>Adicionar um Novo Animal</h1>
    <form class="create-form" action="{{ url_for('create_task') }}" method="POST">
        <label for="nome">Nome Popular:</label>
        <input type="text" id="nome" name="nome" required placeholder="Ex: Arara-azul">

        <label for="nome_cientifico">Nome Científico:</label>
        <input type="text" id="nome_cientifico" name="nome_cientifico" required placeholder="Ex: Anodorhynchus hyacinthinus">
        
        <label for="status">Status de Conservação:</label>
        <input type="text" id="status" name="status" required placeholder="Ex: Vulnerável (VU)">

        <label for="regiao">Região:</label>
        <input type="text" id="regiao" name="regiao" required placeholder="Ex: Amazônia, Cerrado">

        <label for="bioma">Bioma:</label>
        <input type="text" id="bioma" name="bioma" required placeholder="Ex: Amazônia">

        <button type="submit">Registrar Animal</button>
    </form>

    <h1>Lista de Animais</h1>
    <div class="animal-grid">
        {% for task in tasks %}
            <div class="animal-card">
                <div class="animal-card-content">
                    <h3>{{ task.nome }}</h3>
                    <p><strong>Nome Científico:</strong> {{ task.nome_cientifico }}</p>
                    
                    {% set status_lower = task.status.lower() %}
                    {% set status_class = 'status-vulnerable' %} {% if 'em perigo' in status_lower or '(en)' in status_lower %}
                        {% set status_class = 'status-endangered' %}
                    {% elif 'criticamente' in status_lower or '(cr)' in status_lower %}
                        {% set status_class = 'status-critical' %}
                    {% endif %}

                    <p><strong>Status:</strong> <span class="status-badge {{ status_class }}">{{ task.status }}</span></p>

                    <p><strong>Região:</strong> {{ task.regiao }}</p>
                    <p><strong>Bioma:</strong> {{ task.bioma }}</p>
                </div>
                <div class="action-buttons">
                    <a href="{{ url_for('edit_task_page', task_id=task.id) }}" class="btn btn-edit">Editar</a>
                    <form action="{{ url_for('delete_task', task_id=task.id) }}" method="POST" onsubmit="return confirm('Tem certeza que deseja excluir?');" style="display:inline;">
                        <button type="submit" class="btn btn-delete">Excluir</button>
                    </form>
                </div>
            </div>
        {% else %}
            <p>Nenhum animal cadastrado ainda.</p>
        {% endfor %}
    </div>

    <div class="pagination">
        {% if pagination.has_prev %}
            <a href="{{ url_for('index', page=pagination.prev_num) }}">Página Anterior</a>
        {% endif %}
        <span>Página {{ pagination.page }} de {{ pagination.pages }}</span>
        {% if pagination.has_next %}
            <a href="{{ url_for('index', page=pagination.next_num) }}">Próxima Página</a>
        {% endif %}
    </div>
</body>
</html>